@startuml
left to right direction
skinparam packageStyle rectangle

' === Acteurs ===
actor "Client (visiteur)" as Client
actor "Membre" as Membre
actor "Préposé" as Prepose
actor "Gérant" as Gerant
actor "SAC" as SAC <<System>>
actor "Institution financière" as InstFin <<System>>

' Un membre est un client inscrit/authentifié
Client <|-- Membre

' === Système ===
rectangle "RentIT (Système de location)" {

  ' Parcours public (sans authentification)
  usecase "Consulter véhicules" as UC_Consulter
  usecase "S'inscrire" as UC_Inscrire

  ' Authentification
  usecase "S'authentifier" as UC_Login

  ' Réservation en ligne (cf. séquence « Réserver »)
  usecase "Réserver véhicule" as UC_Reserver
  usecase "Vérifier âge & catégorie\n(18/21/25)" as UC_Age
  usecase "Vérifier crédit dispo (500$)" as UC_Blocage
  usecase "Choisir succursale, date & heure" as UC_Choisir
  usecase "Chercher véhicules disponibles" as UC_Dispo
  usecase "Confirmer réservation" as UC_Confirmer

  ' Comptoir — Départ (cf. début de « Retour »)
  usecase "Prendre possession" as UC_Depart
  usecase "Préparer véhicule\n(km, essence, photos)" as UC_Preparer
  usecase "Percevoir paiement (cash/débit/crédit)" as UC_Payer
  usecase "Autoriser paiement" as UC_Autoriser

  ' Comptoir — Retour (cf. fin de « Retour »)
  usecase "Retourner véhicule" as UC_Retour
  usecase "Inspection retour\n(km/essence/état)" as UC_Inspecter
  usecase "Calculer frais supplémentaires" as UC_Frais
  usecase "Clôturer location\n(libérer/ajuster 500$)" as UC_Cloturer

  ' Gestion interne
  usecase "Gérer inventaire & disponibilités" as UC_Inventaire
}

' === Associations acteur ↔ cas d’utilisation ===
Client --> UC_Consulter
Client --> UC_Inscrire
Membre --> UC_Reserver

Prepose --> UC_Depart
Prepose --> UC_Retour
Prepose --> UC_Cloturer

Gerant --> UC_Inventaire

SAC --> UC_Autoriser
InstFin --> UC_Autoriser

' === Relations entre cas d’utilisation ===
' Réserver (inclut les étapes obligatoires selon la séquence « Réserver »)
UC_Reserver --> UC_Login      : <<include>>   ' s’identifier (ou s’inscrire avant)
UC_Reserver --> UC_Age        : <<include>>   ' règle 18/21/25 selon catégorie
UC_Reserver --> UC_Blocage    : <<include>>   ' blocage 500$ via système externe
UC_Reserver --> UC_Choisir    : <<include>>
UC_Reserver --> UC_Dispo      : <<include>>
UC_Reserver --> UC_Confirmer  : <<include>>

' Départ au comptoir (préparation + paiement autorisé)
UC_Depart --> UC_Preparer     : <<include>>
UC_Depart --> UC_Payer        : <<include>>
UC_Payer  --> UC_Autoriser    : <<include>>   ' SAC / Institution financière

' Retour au comptoir (inspection, frais éventuels, clôture)
UC_Retour --> UC_Inspecter    : <<include>>
UC_Inspecter --> UC_Frais     : <<extend>>    ' seulement si dépassement/dommages/carburant
UC_Retour --> UC_Cloturer     : <<include>>

@enduml
